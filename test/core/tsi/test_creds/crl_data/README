The test credentials have been generated with the following
commands:

The ca is self-signed:
----------------------

$ openssl req -x509 -new -newkey rsa:2048 -nodes -keyout ca.key -out ca.pem \
  -config ca-openssl.cnf -days 3650 -extensions v3_req
When prompted for certificate information, everything is default.

valid is issued by CA:
----------------------------------------------------------------------------

$ openssl genrsa -out valid.key.rsa 2048
$ openssl pkcs8 -topk8 -in valid.key.rsa -out valid.key -nocrypt
$ openssl req -new -key valid.key -out valid.csr

When prompted for certificate information, everything is default except the
common name which is set to valid.

$ openssl x509 -req -CA ca.pem -CAkey ca.key -CAcreateserial -in valid.csr \
  -out valid.pem  -days 3650

revoked is issued by CA:
-----------------------

$ openssl genrsa -out revoked.key.rsa 2048
$ openssl pkcs8 -topk8 -in revoked.key.rsa -out revoked.key -nocrypt
$ openssl req -new -key revoked.key -out revoked.csr

When prompted for certificate information, everything is default except the
common name which is set to revoked.

$ openssl x509 -req -CA ca.pem -CAkey ca.key -CAcreateserial -in revoked.csr \
  -out revoked.pem -days 3650

$ openssl ca -revoke revoked.pem -keyfile ca.key -cert ca.pem -days 3650

Generate the CRL file:
----------------------------------------------------------------------------
$ openssl ca -gencrl -out current.crl -keyfile ca.key -cert ca.pem -crldays 3650
$ openssl rehash ./

Generate a chain with a leaf cert signed by an intermediate CA and revoke the intermediate certificate
----------------------------------------------------------------------------

The fully verified chain will be root_ca -> intermediate_ca -> leaf

Generating the intermediate CA
$ openssl genrsa -out temp.rsa 2048
$ openssl pkcs8 -topk8 -in temp.rsa -out intermediate_ca.key -nocrypt
$ rm temp.rsa
$ openssl req -key intermediate_ca.key -new -out temp.csr -config intermediate.cnf
$ openssl x509 -req -days 3650 -in temp.csr -CA ca.pem -CAkey ca.key -CAcreateserial -out intermediate_ca.pem -extfile intermediate.cnf -extensions 'v3_req'

Generating the leaf and chain
$ openssl genrsa -out temp.rsa 2048
$ openssl pkcs8 -topk8 -in temp.rsa -out leaf_signed_by_intermediate.key -nocrypt
$ openssl req -key leaf_signed_by_intermediate.key -new -out temp.csr -config leaf_signed_by_intermediate.cnf
$ openssl x509 -req -days 3650 -in temp.csr -CA intermediate_ca.pem -CAkey intermediate_ca.key -CAcreateserial -out leaf_signed_by_intermediate.pem -extfile leaf_signed_by_intermediate.cnf -extensions 'v3_req'
$ cat leaf_signed_by_intermediate.pem intermediate_ca.pem > leaf_and_intermediate_chain.pem


$ openssl ca -revoke intermediate_ca.pem -keyfile ca.key -cert ca.pem -days 3650
$ openssl ca -gencrl -out current.crl -keyfile ca.key -cert ca.pem -crldays 3650

$ openssl ca -gencrl -out intermediate.crl -keyfile intermediate_ca.key -cert intermediate_ca.pem -crldays 3650
$ cp *.crl ./crls/
$ openssl rehash ./crls/

Clean up:
---------
$ rm *.rsa
$ rm *.csr
$ rm ca.srl

demoCA folder:
----------------------------------------------------------------------------

The demoCA folder contains files used by the openssl CA commands to revoke 
credentials and create CRL files.
